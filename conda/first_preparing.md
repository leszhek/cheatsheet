## Подготовка среды conda.
[Вернуться](./)

В этом разделе все, чтобы организовать удобное рабочее место.<br>
Речь пойдет о macos (и Intel, и Silicon, о чем будут особые отметки, если инструкции отличаются).

Инструкции приведены в порядке установки на чистую платформу. Поехали.

### Подготовка

1. Устанавливаем инструменты командной строки (они пригодятся в будущем):
```
xcode-select --install
```
Откроется окно, нужно подтвердить действие и подождать.

2. Перейти на сайт [brew.sh](https://brew.sh/index_ru), выбрать нужный язык и скопировать ссылку из окошка:
```
$ /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```
Скрипт расскажет, что он собирается делать и попросит подтверждения (для M1 - будет еще один пункт)

3. Установим git и miniconda:
```
brew insatll git
brew install --cask miniconda

```
*(подробнее о brew будет отдельно)*


### Первичная настройка

В документации советуют оставить среду (base) нетронутой, а пользоваться другими средами.

1. Для начала conda нужно инициализировать (о чем homebrew вам обязательно напишет):
```
==> Caveats
Please run the following to setup your shell:
  conda init "$(basename "${SHELL}")"
```

Что ж - это и делаем:
```
$ conda init "$(basename "${SHELL}")"
```

Если вы не хотите, чтобы конда каждый раз грузилась по умолчанию, просто поставьте ее в "тихий режим":
```
conda config --set auto_activate_base false
```
Но тогда, для работы со средами потребуется ее активировать вручную:
```
conda activate
```

2. Настраиваем источники пакетов (добавим ветку conda-forge и сделаем ее главной)
```
$ conda config --add channels conda-forge
$ conda config --set channel_priority true
```

Эти команды запишут в файл конфигурации **~/.condarc**:

```
channels:
  - conda-forge
  - defaults
channel_priority: flexible
```
Где **channels_priority** может принимать значения:
- strict (строго)
- flexible (гибко)
- disabled (отключено)

При **strict** пакеты в каналах с более низким приоритетом не рассматриваются, если пакет с тем же именем есть в канале с более высоким приоритетом.

Благодаря **flexible** приоритету установщик может использовать каналы с более низким приоритетом для удовлетворения зависимостей, а не вызывать недопустимую ошибку.

И, наконец, в **disable** приоритет имеет версия пакета.

3. Если нужно, создаем новую среду, например - dev, и переключаемся на нее:
```
$ conda create --name dev
$ conda activate dev
```

4. Устанавливаем все, что нам нужно (вручную):
```
$ conda install python=3.9.1 re2 requests nbconvert=5.6.1 notebook jupyter_contrib_nbextensions ipywidgets ...
```

Если все пройдет правильно - при запуске jupyter notebook ошибок не будет.